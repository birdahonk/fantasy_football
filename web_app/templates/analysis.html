{% extends "base.html" %}

{% block title %}Analysis - Fantasy Football AI General Manager{% endblock %}

{% block content %}
<div class="analysis-container">
    <h2 class="card-title">üìä Team Analysis</h2>
    <p class="mb-3">Comprehensive analysis of your fantasy football team, including performance insights and AI-powered recommendations.</p>
    
    <!-- Analysis Controls -->
    <div class="analysis-controls mb-3">
        <div class="dashboard-card">
            <h3 class="card-title">üéõÔ∏è Analysis Controls</h3>
            <div class="control-grid">
                <div class="control-group">
                    <label for="analysisType">Analysis Type:</label>
                    <select id="analysisType" class="control-select">
                        <option value="roster">Roster Analysis</option>
                        <option value="weekly">Weekly Performance</option>
                        <option value="matchup">Matchup Analysis</option>
                        <option value="trends">Performance Trends</option>
                        <option value="projections">Future Projections</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="weekSelect">Week:</label>
                    <select id="weekSelect" class="control-select">
                        <option value="current">Current Week</option>
                        <option value="1">Week 1</option>
                        <option value="2">Week 2</option>
                        <option value="3">Week 3</option>
                        <option value="4">Week 4</option>
                        <option value="5">Week 5</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="depth">Analysis Depth:</label>
                    <select id="depth" class="control-select">
                        <option value="quick">Quick Overview</option>
                        <option value="detailed">Detailed Analysis</option>
                        <option value="comprehensive">Comprehensive Report</option>
                    </select>
                </div>
                <div class="control-group">
                    <button class="btn btn-primary" onclick="runAnalysis()">üöÄ Run Analysis</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Current Analysis Status -->
    <div class="analysis-status mb-3">
        <div class="dashboard-card">
            <h3 class="card-title">üìà Analysis Status</h3>
            <div class="status-grid">
                <div class="status-item">
                    <span class="status-icon">‚è≥</span>
                    <div class="status-content">
                        <h4>Roster Analysis</h4>
                        <p>Pending - Will run once API integration is complete</p>
                    </div>
                </div>
                <div class="status-item">
                    <span class="status-icon">‚è≥</span>
                    <div class="status-content">
                        <h4>Weekly Performance</h4>
                        <p>Pending - Will run once API integration is complete</p>
                    </div>
                </div>
                <div class="status-item">
                    <span class="status-icon">‚è≥</span>
                    <div class="status-content">
                        <h4>Matchup Analysis</h4>
                        <p>Pending - Will run once API integration is complete</p>
                    </div>
                </div>
                <div class="status-item">
                    <span class="status-icon">‚è≥</span>
                    <div class="status-content">
                        <h4>AI Recommendations</h4>
                        <p>Pending - Will run once API integration is complete</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Sample Analysis Results -->
    <div class="sample-analysis mb-3">
        <div class="dashboard-card">
            <h3 class="card-title">üîç Sample Analysis (Mock Data)</h3>
            <div class="analysis-tabs">
                <div class="tab-buttons">
                    <button class="tab-btn active" data-tab="overview">Overview</button>
                    <button class="tab-btn" data-tab="strengths">Strengths</button>
                    <button class="tab-btn" data-tab="weaknesses">Weaknesses</button>
                    <button class="tab-btn" data-tab="recommendations">Recommendations</button>
                </div>
                
                <div class="tab-content">
                    <div class="tab-pane active" id="overview">
                        <h4>Team Overview</h4>
                        <div class="overview-stats">
                            <div class="stat-card">
                                <span class="stat-value">B+</span>
                                <span class="stat-label">Overall Grade</span>
                            </div>
                            <div class="stat-card">
                                <span class="stat-value">8.5/10</span>
                                <span class="stat-label">Depth Score</span>
                            </div>
                            <div class="stat-card">
                                <span class="stat-value">7.2/10</span>
                                <span class="stat-label">Flexibility</span>
                            </div>
                            <div class="stat-card">
                                <span class="stat-value">9.1/10</span>
                                <span class="stat-label">Star Power</span>
                            </div>
                        </div>
                        <p class="analysis-text">
                            Your team shows strong potential with excellent quarterback play and solid running back depth. 
                            The wide receiver corps could use some improvement, and you might want to consider upgrading 
                            your tight end position for better weekly consistency.
                        </p>
                    </div>
                    
                    <div class="tab-pane" id="strengths">
                        <h4>Team Strengths</h4>
                        <ul class="strength-list">
                            <li><strong>Elite QB Play:</strong> Patrick Mahomes provides consistent high-level performance</li>
                            <li><strong>RB Depth:</strong> Christian McCaffrey is a top-tier RB1 with excellent upside</li>
                            <li><strong>Big Play Potential:</strong> Tyreek Hill offers explosive scoring potential</li>
                            <li><strong>Kicker Stability:</strong> Justin Tucker is one of the most reliable kickers</li>
                        </ul>
                    </div>
                    
                    <div class="tab-pane" id="weaknesses">
                        <h4>Areas for Improvement</h4>
                        <ul class="weakness-list">
                            <li><strong>WR Depth:</strong> Need more consistent WR2/WR3 options</li>
                            <li><strong>TE Production:</strong> Travis Kelce is aging, consider backup options</li>
                            <li><strong>Bench Depth:</strong> Could use more high-upside bench players</li>
                            <li><strong>Injury Risk:</strong> Some key players have injury history</li>
                        </ul>
                    </div>
                    
                    <div class="tab-pane" id="recommendations">
                        <h4>AI Recommendations</h4>
                        <div class="recommendation-list">
                            <div class="recommendation-item">
                                <span class="rec-priority high">High Priority</span>
                                <p>Target a high-upside WR2 in free agency or trades</p>
                            </div>
                            <div class="recommendation-item">
                                <span class="rec-priority medium">Medium Priority</span>
                                <p>Consider adding a backup TE with upside</p>
                            </div>
                            <div class="recommendation-item">
                                <span class="rec-priority low">Low Priority</span>
                                <p>Monitor the waiver wire for emerging players</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Analysis History -->
    <div class="analysis-history mt-3">
        <div class="dashboard-card">
            <h3 class="card-title">üìö Analysis History</h3>
            <div class="history-content">
                <p><em>Analysis history will be stored once the system is fully operational.</em></p>
                <p class="text-center mt-2">
                    <small>Previous analyses will be available for comparison and trend analysis</small>
                </p>
                <div class="mt-2">
                    <button class="btn" onclick="exportAnalysis()">Export Analysis</button>
                    <button class="btn" onclick="compareAnalyses()">Compare Analyses</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Quick Actions -->
    <div class="quick-actions mt-3">
        <div class="dashboard-card">
            <h3 class="card-title">‚ö° Quick Actions</h3>
            <div class="action-grid">
                <a href="{{ url_for('team') }}" class="btn">üë• View Roster</a>
                <a href="{{ url_for('free_agents') }}" class="btn">üÜì Browse Free Agents</a>
                <a href="{{ url_for('matchup') }}" class="btn">‚öîÔ∏è Check Matchup</a>
                <a href="{{ url_for('chat') }}" class="btn">ü§ñ AI Chat</a>
            </div>
        </div>
    </div>
</div>

<style>
.control-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    align-items: end;
}

.control-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.control-group label {
    font-weight: bold;
    color: var(--yellow);
}

.control-select {
    background: var(--black);
    color: var(--primary-green);
    border: 2px solid var(--primary-green);
    padding: 0.75rem;
    font-family: inherit;
    font-size: 1rem;
    border-radius: 4px;
    min-height: 44px;
}

.control-select:focus {
    outline: none;
    box-shadow: 0 0 15px var(--primary-green);
}

.status-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
}

.status-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    border: 1px solid var(--primary-green);
    border-radius: 4px;
    background: rgba(0, 255, 0, 0.05);
}

.status-icon {
    font-size: 2rem;
}

.status-content h4 {
    color: var(--yellow);
    margin-bottom: 0.25rem;
}

.status-content p {
    font-size: 0.9rem;
    color: var(--secondary-green);
}

.analysis-tabs {
    margin-top: 1rem;
}

.tab-buttons {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
}

.tab-btn {
    padding: 0.75rem 1.5rem;
    background: var(--black);
    color: var(--primary-green);
    border: 2px solid var(--primary-green);
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.tab-btn.active {
    background: var(--primary-green);
    color: var(--black);
}

.tab-btn:hover:not(.active) {
    background: rgba(0, 255, 0, 0.1);
}

.tab-content {
    min-height: 300px;
}

.tab-pane {
    display: none;
}

.tab-pane.active {
    display: block;
}

.overview-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 1rem;
    margin: 1rem 0;
}

.stat-card {
    text-align: center;
    padding: 1rem;
    border: 1px solid var(--primary-green);
    border-radius: 4px;
    background: rgba(0, 255, 0, 0.05);
}

.stat-value {
    display: block;
    font-size: 1.5rem;
    font-weight: bold;
    color: var(--yellow);
    margin-bottom: 0.5rem;
}

.stat-label {
    font-size: 0.9rem;
    color: var(--secondary-green);
}

.analysis-text {
    line-height: 1.6;
    margin: 1rem 0;
}

.strength-list,
.weakness-list {
    list-style: none;
    padding: 0;
}

.strength-list li,
.weakness-list li {
    padding: 0.5rem 0;
    border-bottom: 1px solid rgba(0, 255, 0, 0.2);
}

.strength-list li:last-child,
.weakness-list li:last-child {
    border-bottom: none;
}

.recommendation-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.recommendation-item {
    padding: 1rem;
    border: 1px solid var(--primary-green);
    border-radius: 4px;
    background: rgba(0, 255, 0, 0.05);
}

.rec-priority {
    display: inline-block;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.8rem;
    font-weight: bold;
    margin-bottom: 0.5rem;
}

.rec-priority.high { background: rgba(255, 0, 0, 0.2); color: #E74C3C; }
.rec-priority.medium { background: rgba(255, 165, 0, 0.2); color: #F39C12; }
.rec-priority.low { background: rgba(0, 255, 0, 0.2); color: #2ECC71; }

.action-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}

.history-content {
    text-align: center;
    padding: 1rem;
}

@media (max-width: 767px) {
    .control-grid {
        grid-template-columns: 1fr;
    }
    
    .status-grid {
        grid-template-columns: 1fr;
    }
    
    .overview-stats {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .tab-buttons {
        flex-direction: column;
    }
    
    .action-grid {
        grid-template-columns: 1fr;
    }
}
</style>

<script>
// Tab functionality
document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', function() {
        const tabId = this.dataset.tab;
        
        // Update active tab button
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
        
        // Update active tab content
        document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
    });
});

function runAnalysis() {
    const analysisType = document.getElementById('analysisType').value;
    const week = document.getElementById('weekSelect').value;
    const depth = document.getElementById('depth').value;
    
    showNotification(`Running ${depth} ${analysisType} analysis for ${week === 'current' ? 'current week' : 'week ' + week}...`, 'info');
    
    // Simulate analysis running (will be replaced with real API calls)
    setTimeout(() => {
        showNotification('Analysis complete! Results displayed above.', 'success');
    }, 3000);
}

function exportAnalysis() {
    showNotification('Analysis exported successfully!', 'success');
    // TODO: Implement export functionality
}

function compareAnalyses() {
    showNotification('Analysis comparison feature coming soon!', 'info');
    // TODO: Implement comparison functionality
}
</script>
{% endblock %}
